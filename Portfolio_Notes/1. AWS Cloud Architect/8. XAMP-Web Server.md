## lect 11
- lets say our fully developed application code is stored in github and now its time to host 
- hosting/deloyment will be done 2/3 places like
	- our machines
	- for static content -->s3 
	- cluster containers where we use micro services
- lets say our code from git hub get deployed on ec2 (web server) and our team(30 people) consists of 10 dev 10 testers and 10 devops and every one wants to access the server.
- [company builds infra once and host it but main thing is managing infra and cost cutting and save money so company most priority for ]
	- cost effective solution 
	- resource management
	- security
- so if every one in team works on server it is very risky
- so requirement is to build a system such that outer traffic shouldnt go to web server - and keep this web server private[not public]
- but atleast 1/2 people have to acess this server to patch up or some thing else so 
- company will ask you to look for a sol so that those 2 people also access it in some other way
- so we use a xamp server [public] and our main/application  server[private] both connected in same vpn[]
- [if two/more servers are in same network bydefault they communicate with each other]
- to access the private server u need a key[stored in local when created]
- use scp cmd store that key secure dedicated path in public xamp server
- whoever want to access the private server go to dedicated path and use ssh to access the private server
- all this happend in cloud
- ![[Pasted image 20221014025734.png]]
- micro services, logs and ...... will be  deployed in the xamp server
- 
## Practical
### Create Ec2 
create 2 instances [1public-xamp, 1 private-webserver]
### Webserver-Private-application server
- go to create ec2
- -->instance
- -->launch instance
- -->name:Webserver
- -->linux image
- -->t2.micro
- -->create new key pair--> name: venkat-->create key pair
- -->network settings-->edit
	- -->vpc --> default
	- -->subnet-->us-east-1
	- -->auto-assign-public-->disable[this is private server]
	- [-->security group-->]
		- -->keep ssh 
		- -->add security group-->HTTP // * for hosting a website*
				- ->source-->anywhere
			-->add security group-->HTTPS
				- ->source-->anywhere ]]

### jump Server(Xamp)-Public 
- -->launch instance
- -->name: Jump server
- -->linux image
- -->t2.micro
- -->create new key pair--> name: venkat-->create key pair[same as Web server- in company we use same key for ]
- -->network settings-->edit
	- -->vpc --> default
	- -->subnet-->us-east-1
	- -->auto-assign-public-->enable[this is public server]
- -->[security group-->]
		- -->all traffic--for now
- -->launch instance

- lets say you want to access webserver to configure something but we cannot access it bcoz it is a private server[no public ip]
- [you can not access it with private ip]-[check it below]
- -->cmd-->cd downloads
- -->ssh ec2-user@172.31.43.218 -i venkat.pem[cmd to access server] 
- you will get no response [but you can access the jump server with foloowing commands]
- copy jump server public ip adress
- -->cmd-->cd downloads
- -->ssh ec2-user@[public ip] -i venkat.pem
- -->yes/no-->yes
- -->linux accessed
- -->sudo -i [to go to root]
- -->clear
- [now you can access private webserver from this public jump server]
- [already you are in root of the public server]
- -->ssh ec2-user@[private ip] -i [access key]
- you will get error since [access key is not stored in the path] so 
- ### There are two methods to do it
## 1. procedure - use Git Bash
- download and install git hub for windows[see 64/ 32 v]
- -->go to downloads [where your access keys are stored]
- -->right click-->show more options-->Git Bash Here
- -->scp -i [jump ser public access key]  [file to be uploades(webserver pvt access key)]  ec2-user@[jump serv public ip ] :
- [scp cmd is to copy remotely]
- -->scp -i venkat.pem venkat.pem ec2-user@3.81.2.0: [uploaded]
- here we use public ip since we cannot access the private ip
## To verify
- access jump server through cmd-->ssh ec2-user@[jump server public ip] -i venkat.pem
- -->ls  //[ *you will see the access key stored here]
- -->ssh ec2-user@[private server ip] -i venkat.pem
- -->yes
- //*[we will get a permission issue]*
- -->sudo chmod 400 [access key]
- [then again ssh private ip server]
- -->ssh ec2-user@[private server ip] -i venkat.pem  //[*accessed private server-----success*]
- -->sudo -i 
- -->exit [ amd to exit from servers]

### next is vpn server

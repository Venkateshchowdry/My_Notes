
- in companies after developer push code to the github
	- jenkins will build the code and send output and trigger ansible server playbook
		- In playbooks it is defined to deploy it to the web server
![[Pasted image 20221115003511.png]]

- we need 5 servers
	- Jenkins-Server
	- Web-Server [in companies it is in ASG to scale depends on traffic]
	- Ansible-Server
	- Developer-Server[local host] and pushes code to github
	- Github
- jenkins and ansible server has password less authentications[research this]

## 1. Jenkins-Server
- create ubuntu instance ami in aws and connect in cli
	- install jenkins[see 3]
		- access through web browser
## 2. Ansible-Server
- create ubuntu instance ami in aws and connect in cli
	- -->sudo apt update
	- -->sudo apt install ansible
	- -->vim /etc/ansible/hosts
		- -->i
		- -->[web]
		- -->ip of webserver
			- here i take the private ip of web server
				- or choose according to SG
		- -->esc -->:wq
## 3. Web-Server
- create ubuntu instance ami in aws and connect in cli
- -->sudo apt update
- -->sudo apt install apache2
- -->apache2 -v
	- to find version of apache tomcat
- -->sudo systemctl start apache2
- -->sudo systemctl enable apache2
- -->sudo systemctl status apache2
- [in place of apache2 we use httpd in amazon linux and rhel centos]
- -->cd /var/www/html/
### creating password less connection between ansible and webservers
- here we have only one server
- go to ansible server
- generate key
	- -->ssh-keygen
		- it will ask for key name : so I gave venkat.pub
- share the key with web server
	- -->ssh-copy-id -i venkat.pub root@[private ip of web server]
		- here we are getting an error bcoz root login of webserver is not open 
			- so[ enable root of webserver]
			- set password for root user[admin pswd] of webserver
			- go to web server CLI
				- -->sudo su
					- -->passwd root
					- -->new password : 12345
					- -->retype : 12345
					- -->success
				- [go to ssh configuration file]
				- -->vim /etc/ssh/sshd_config
					- search for these two
					- PermitRootLogin yes
						- [uncomment] this one
					- PasswordAuthentication no
						- change this one to [yes]
					- esc -->:wq
			- -->systemctl restart sshd
- go back to ansible server CLI and share the key with the webserver
	- -->ssh-copy-id -i venkat.pub root@[private ip of web server]
		- key added successfully 
- --> ssh root@[web-server private key]
	- [we are accessing webserver from ansible server without password]
		- success
- -->exit for webserver
### same as above password less communnication between jenkins and ansible server
#### jenkins server 
#### ansible server
here we are sharing the key between two servers
- do the same process and access ansible server from the jenkins server
## 4. generate a playbook in ansible
- -->mkdir sourcecode
- -->cd sourcecode
	- -->vi playbook.yml [it follows indendation]
		- we are creating a simple copy playbook
		- -hosts : all
		- tasks:
			- - copy : 
				- src : /opt/index.html [in this folder our jenkins server will place the build file, index.html is the filename if we donk know we will ask developer]
				- dest : /var/www/html [of the webservers]
				- esc-->:wq
 
